!function(){"use strict";var t,n=0,i=window.requestAnimationFrame||window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||function(i){var e=Math.max(0,16-((t=(new Date).getTime())-n)),r=setTimeout(function(){i(t+e)},e);return n=t+e,r},e=window.cancelAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.oCancelRequestAnimationFrame||function(t){clearTimeout(t)},r=function(){return this.init()};r.prototype={init:function(){this._objects=[],this._triggers={};var t=this;return"ontouchstart"in window?(this._start="touchstart",this._end="touchend"):(this._start="mousedown",this._end="mouseup"),window.addEventListener("keydown",function(n){for(var i=t._triggers[n.keyCode]||[],e=0,r=i.length;r>e;e++){var s=i[e],a=s[0],o=s[1],u=o.ms;(o=a._actions[o.start]).status||t._raf(a,o,u)}}),window.addEventListener("keyup",function(n){for(var i=t._triggers[n.keyCode]||[],e=0,r=i.length;r>e;e++){var s=i[e],a=s[0],o=s[1],u=o.ms;if(o.end){var c=a._actions[o.start];(o=a._actions[o.end]).status||t._raf(a,t._keyupWrapper(c,o),u)}}}),this},_keyupWrapper:function(t,n){return{cb:function(i){var r=n.cb(i);r||(e(t.status),delete t.status)}}},_raf:function(t,n,e){var r,s=this,a=function(t){r||(r=t);var o=!0,u=t-r;u>=e(s)&&(r=0,o=n.cb(s)),o?n.status=i(a):delete n.status};n.status=i(a)},trigger:function(t,n){var i=this,e=n.trigger,r=t._actions[n.start],s=t._actions[n.end],a=n.ms;e&&(e.addEventListener(this._start,function(n){r.status||i._raf(t,r,a),n.preventDefault()}),s&&e.addEventListener(this._end,function(n){s.status||i._raf(t,i._keyupWrapper(r,s),a),n.preventDefault()}))},createObject:function(){return this._Object.apply(this,[this].concat(arguments))}};var s=r.prototype._Object=function(t){return this instanceof s?((this._game=t)._objects.push(this),this.init()):new this._Object(t)};s.prototype={init:function(){return this._actions={},this},action:function(t,n){var i=this;return this._actions[t]={cb:function(){return n.apply(i,arguments)}},this},trigger:function(t){return"start"in t&&!(t.start in this._actions)||"end"in t&&!(t.end in this._actions)?this:(t.ms=this._ms(t.ms),"number"==typeof t.trigger&&"trigger"in t?((this._game._triggers[t.trigger]=this._game._triggers[t.trigger]||[]).push([this,t]),this):(this._game.trigger(this,t),this))},_ms:function(t){var n=this;return"function"==typeof t?function(){return t.apply(n,arguments)}:function(){return t}}},"function"==typeof define&&define.amd?define("Reanime",r):window.Reanime=r}();